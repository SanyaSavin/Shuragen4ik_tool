<Window x:Class="WpfApp3.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:WpfApp3"
        Title="Shuragen4ik Tool"
        Height="900" Width="1000"
        MinWidth="600" MinHeight="500"
        ResizeMode="CanResize"
        WindowStartupLocation="CenterScreen"
        Background="#121212" Foreground="White">
    <Window.Resources>
        <local:EnumToBooleanConverter x:Key="EnumToBoolConverter"/>
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>
        <local:BoolToColorConverter x:Key="BoolToColor"/>
        <local:BoolToBoldConverter x:Key="BoolToBold"/>
        <Style x:Key="HeaderStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#B388FF"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Margin" Value="5,25,0,8"/>
        </Style>
        <Style x:Key="DescStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#888"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
            <Setter Property="Margin" Value="0,2,0,10"/>
            <Setter Property="LineHeight" Value="16"/>
        </Style>
        <Style x:Key="GroupBorder" TargetType="Border">
            <Setter Property="Background" Value="#1E1E1E"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="20,15"/>
            <Setter Property="Margin" Value="0,0,0,10"/>
            <Setter Property="BorderBrush" Value="#2A2A2A"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>
        <Style TargetType="CheckBox">
            <Setter Property="Foreground" Value="#EEEEEE"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Margin" Value="0,8,0,0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="CheckBox">
                        <Grid Background="Transparent">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <ContentPresenter VerticalAlignment="Center"/>
                            <Border Grid.Column="1" x:Name="Border" Width="44" Height="22" CornerRadius="11" Background="#333" BorderBrush="#555" BorderThickness="1">
                                <Ellipse x:Name="Dot" Width="18" Height="18" Fill="#999" HorizontalAlignment="Left" Margin="2,0,0,0">
                                    <Ellipse.Effect>
                                        <DropShadowEffect ShadowDepth="1" BlurRadius="2" Opacity="0.3"/>
                                    </Ellipse.Effect>
                                </Ellipse>
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#6200EA"/>
                                <Setter TargetName="Border" Property="BorderBrush" Value="#7C4DFF"/>
                                <Setter TargetName="Dot" Property="Fill" Value="White"/>
                                <Setter TargetName="Dot" Property="HorizontalAlignment" Value="Right"/>
                                <Setter TargetName="Dot" Property="Margin" Value="0,0,2,0"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="Border" Property="Opacity" Value="0.5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="{x:Type ComboBox}">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Background" Value="#2D2D2D"/>
            <Setter Property="BorderBrush" Value="#444"/>
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="OverridesDefaultStyle" Value="True"/>
            <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto"/>
            <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto"/>
            <Setter Property="ScrollViewer.CanContentScroll" Value="True"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ComboBox}">
                        <Grid>
                            <ToggleButton Name="ToggleButton" Template="{DynamicResource ComboBoxToggleButton}" Grid.Column="2" Focusable="false" IsChecked="{Binding Path=IsDropDownOpen,Mode=TwoWay,RelativeSource={RelativeSource TemplatedParent}}" ClickMode="Press"/>
                            <ContentPresenter Name="ContentSite" IsHitTestVisible="False" Content="{TemplateBinding SelectionBoxItem}" ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}" ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}" Margin="10,0,30,0" VerticalAlignment="Center" HorizontalAlignment="Left" />
                            <Popup Name="Popup" Placement="Bottom" IsOpen="{TemplateBinding IsDropDownOpen}" AllowsTransparency="True" Focusable="False" PopupAnimation="Slide">
                                <Grid Name="DropDown" SnapsToDevicePixels="True" MinWidth="{TemplateBinding ActualWidth}" MaxHeight="{TemplateBinding MaxDropDownHeight}">
                                    <Border x:Name="DropDownBorder" Background="#252525" BorderThickness="1" BorderBrush="#555" CornerRadius="5"/>
                                    <ScrollViewer Margin="2" SnapsToDevicePixels="True">
                                        <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Contained" />
                                    </ScrollViewer>
                                </Grid>
                            </Popup>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <ControlTemplate x:Key="ComboBoxToggleButton" TargetType="{x:Type ToggleButton}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition Width="30" />
                </Grid.ColumnDefinitions>
                <Border x:Name="Border" Grid.ColumnSpan="2" CornerRadius="5" Background="#2D2D2D" BorderBrush="#444" BorderThickness="1" />
                <Path x:Name="Arrow" Grid.Column="1" HorizontalAlignment="Center" VerticalAlignment="Center" Data="M 0 0 L 4 4 L 8 0 Z" Fill="#BBB" />
            </Grid>
            <ControlTemplate.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter TargetName="Border" Property="Background" Value="#383838" />
                    <Setter TargetName="Arrow" Property="Fill" Value="White" />
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>
        <Style TargetType="{x:Type ComboBoxItem}">
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="OverridesDefaultStyle" Value="True"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ComboBoxItem}">
                        <Border x:Name="Border" Padding="10,8" Background="Transparent" SnapsToDevicePixels="true">
                            <ContentPresenter />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#3D3D3D"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#6200EA"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ScrollBarThumb" TargetType="{x:Type Thumb}">
            <Setter Property="OverridesDefaultStyle" Value="true"/>
            <Setter Property="IsTabStop" Value="false"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Thumb}">
                        <Border x:Name="rectangle" Background="#444" CornerRadius="4" Height="{TemplateBinding Height}" SnapsToDevicePixels="True" Width="{TemplateBinding Width}"/>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="true">
                                <Setter Property="Background" TargetName="rectangle" Value="#666"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style TargetType="{x:Type ScrollBar}">
            <Setter Property="Stylus.IsFlicksEnabled" Value="false"/>
            <Setter Property="Foreground" Value="#ADADAD"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Width" Value="10"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ScrollBar}">
                        <Grid x:Name="GridRoot" Width="10" Background="Transparent">
                            <Track x:Name="PART_Track" IsDirectionReversed="true" Focusable="false">
                                <Track.Thumb>
                                    <Thumb Style="{StaticResource ScrollBarThumb}"/>
                                </Track.Thumb>
                            </Track>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Border Grid.Row="0" Background="#1A1A1A" Padding="25,20" BorderBrush="#333" BorderThickness="0,0,0,1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" VerticalAlignment="Center">
                    <TextBlock Text="ULTIMATE SYSTEM UTILITY" Foreground="#666" FontSize="11" FontWeight="Bold"/>
                    <TextBlock Text="Shuragen4ik Tool" Foreground="White" FontSize="26" FontWeight="SemiBold"/>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">

                    <Border Background="#222" CornerRadius="4" Padding="8,4" VerticalAlignment="Center" Margin="0,0,20,0">
                        <TextBlock Text="v1.3.1" Foreground="#B388FF" FontSize="10" FontWeight="Bold"/>
                    </Border>

                    <Border Background="#252525" CornerRadius="20" Padding="5,5,15,5" BorderBrush="#333" BorderThickness="1">
                        <StackPanel Orientation="Horizontal">
                            <Grid Width="32" Height="32">
                                <Ellipse Fill="#6200EA"/>
                                <Path Data="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z" 
                                      Fill="White" Stretch="Uniform" Margin="6"/>
                            </Grid>

                            <StackPanel Margin="10,0,0,0" VerticalAlignment="Center">
                                <TextBlock Text="{Binding CurrentUserName}" Foreground="White" FontWeight="Bold" FontSize="13"/>
                                <TextBlock Text="Administrator" Foreground="#888" FontSize="10"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Grid>
        </Border>

        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled" Padding="0,0,0,20">
            <StackPanel Margin="25,10,25,20">

                <!-- СХЕМА ЭЛЕКТРОПИТАНИЯ -->
                <TextBlock Text="СХЕМА ЭЛЕКТРОПИТАНИЯ" Style="{StaticResource HeaderStyle}"/>
                <Border Style="{StaticResource GroupBorder}">
                    <StackPanel>
                        <TextBlock Text="Выберите схему (мгновенное применение):" Foreground="#AAA" FontSize="12" Margin="0,0,0,10"/>
                        <ComboBox ItemsSource="{Binding PowerPlans}"
                                  SelectedItem="{Binding SelectedPowerPlan}"
                                  DisplayMemberPath="Name"
                                  SelectedValuePath="Name"
                                  Height="45" Cursor="Hand"/>
                        <TextBlock Text="* Программа автоматически находит все доступные схемы в Windows." Foreground="#555" FontSize="10" Margin="2,5,0,0"/>
                    </StackPanel>
                </Border>

                <!-- ГИБЕРНАЦИЯ -->
                <TextBlock Text="ГИБЕРНАЦИЯ" Style="{StaticResource HeaderStyle}" />
                <Border Style="{StaticResource GroupBorder}">
                    <StackPanel>
                        <CheckBox Content="Разрешить Гибернацию" IsChecked="{Binding IsHibernationEnabled}"/>
                        <TextBlock Text="При выключении освобождает немного место на диске, но если у вас ноутбук и в спящем режиме крутятся вентиляторы, то включите этот пункт" Style="{StaticResource DescStyle}"/>
                    </StackPanel>
                </Border>
                <TextBlock Text="НАСТРОЙКИ ПРОВОДНИКА" Style="{StaticResource HeaderStyle}"/>
                <Border Style="{StaticResource GroupBorder}">
                    <StackPanel>
                        <CheckBox Content="Показывать скрытые файлы и папки" IsChecked="{Binding IsHiddenFilesVisible}"/>
                        <TextBlock Text="Отображает скрытые системой файлы." Style="{StaticResource DescStyle}"/>
                        <CheckBox Content="Показывать расширения файлов" IsChecked="{Binding IsFileExtensionsVisible}"/>
                        <TextBlock Text="Отображает типы файлов (.exe, .jpg)." Style="{StaticResource DescStyle}"/>
                    </StackPanel>
                </Border>

                <TextBlock Text="ИГРОВАЯ ОПТИМИЗАЦИЯ" Style="{StaticResource HeaderStyle}"/>
                <Border Style="{StaticResource GroupBorder}">
                    <StackPanel>
                        <CheckBox Content="Включить оптимизацию во весь экран (FSO)" IsChecked="{Binding IsFsoEnabled}"/>
                        <TextBlock Text="ВКЛ: Стандартный режим. ВЫКЛ: Эксклюзивный режим (Legacy)." Style="{StaticResource DescStyle}"/>
                        <CheckBox Content="Оптимизация оконных игр" IsChecked="{Binding IsWindowedGameOptEnabled}"/>
                        <TextBlock Text="Flip Model для игр в окне." Style="{StaticResource DescStyle}"/>
                        <CheckBox Content="Отключить MPO (Multi-Plane Overlay)" IsChecked="{Binding IsMPODisabled}"/>
                        <TextBlock Text="Фикс мерцания (Nvidia/AMD)." Style="{StaticResource DescStyle}"/>
                    </StackPanel>
                </Border>

                <TextBlock Text="БЕЗОПАСНОСТЬ ПРОЦЕССОРА" Style="{StaticResource HeaderStyle}"/>
                <Border Style="{StaticResource GroupBorder}">
                    <StackPanel>
                        <CheckBox Content="Отключить Spectre и Meltdown" IsChecked="{Binding IsSpectreDisabled}"/>
                        <TextBlock Text="Отключает патчи безопасности CPU. Повышает FPS." Style="{StaticResource DescStyle}"/>
                        <CheckBox Content="Отключить Downfall Mitigation" IsChecked="{Binding IsDownfallDisabled}"/>
                        <TextBlock Text="Отключает защиту AVX2 на Intel 12+ gen." Style="{StaticResource DescStyle}"/>
                        <CheckBox Content="Отключить Windows Defender" IsChecked="{Binding IsDefenderDisabled}"/>
                        <TextBlock Text="Полностью отключает Защитник Windows (реальное время, сканирование). Скрывает раздел 'Безопасность Windows' в Параметрах." Style="{StaticResource DescStyle}"/>
                        <CheckBox Content="Включить Intel TSX" IsChecked="{Binding IsTsxEnabled}"
                                  Margin="0,12,0,0"/>
                        <TextBlock Text="Добавляет поддержку аппаратной транзакционной памяти, что помогает ускорить выполнение многопоточного программного обеспечения за счет безопасности.&#x0a;Выключение: фикс уязвимости TAA + небольшой прирост FPS. Требует перезагрузки."
                                   Style="{StaticResource DescStyle}"/>
                    </StackPanel>
                </Border>

                <TextBlock Text="СИСТЕМА" Style="{StaticResource HeaderStyle}"/>
                <Border Style="{StaticResource GroupBorder}">
                    <StackPanel>
                        <CheckBox Content="Отключить SysMain (Superfetch)" IsChecked="{Binding IsSysMainDisabled}"/>
                        <TextBlock Text="Отключает кэширование ПО в ОЗУ. Полезно для SSD, вредно для HDD." Style="{StaticResource DescStyle}"/>

                        <CheckBox Content="Группировать службы (SvcHost)" IsChecked="{Binding IsServiceGroupingEnabled}"/>
                        <TextBlock Text="ВКЛ: Экономия ОЗУ. ВЫКЛ: Стабильность." Style="{StaticResource DescStyle}"/>
                        <CheckBox Content="Отключить имена 8.3 (NTFS)" IsChecked="{Binding IsNtfs8dot3Disabled}"/>
                        <TextBlock Text="Ускорение файловой системы." Style="{StaticResource DescStyle}"/>
                    </StackPanel>
                </Border>


                <TextBlock Text="СЖАТИЕ СИСТЕМЫ" Style="{StaticResource HeaderStyle}" Foreground="#00E5FF"/>
                <Border Style="{StaticResource GroupBorder}" BorderBrush="#00E5FF" BorderThickness="1">
                    <StackPanel>
                        <TextBlock Text="Compact OS" FontWeight="Bold" Foreground="#00E5FF" Margin="0,0,0,5"/>
                        <TextBlock Text="Сжимает файлы операционной системы для экономии места (освобождает 1.5 - 2.5 ГБ). Не влияет на производительность на SSD." 
                   Style="{StaticResource DescStyle}"/>

                        <Grid Margin="0,5,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="15"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <Button Grid.Column="0" Click="BtnCompactOn_Click" Height="40" Background="#2D2D2D" Cursor="Hand">
                                <TextBlock Text="📦 Включить Compact" Foreground="White"/>
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="5" BorderBrush="#00E5FF" BorderThickness="1">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>

                            <Button Grid.Column="2" Click="BtnCompactOff_Click" Height="40" Background="#2D2D2D" Cursor="Hand">
                                <TextBlock Text="🔓 Выключить" Foreground="White"/>
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="5" BorderBrush="#555" BorderThickness="1">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                            
                        </Grid>
                    </StackPanel>
                    
                </Border>

                <TextBlock Text="ОБНОВЛЕНИЯ WINDOWS" Style="{StaticResource HeaderStyle}" Foreground="#FF4500"/>
                <Border Style="{StaticResource GroupBorder}" BorderBrush="#FF4500" BorderThickness="1">
                    <StackPanel>
                        <TextBlock Text="Полностью отключить обновления Windows" 
                   FontWeight="Bold" Foreground="White" FontSize="14" Margin="0,0,0,10"/>
                        <TextBlock Text="Блокирует все автоматические обновления (кумулятивные, безопасности, функции). Windows не будет проверять или скачивать обновления. Microsoft Store работает."
                   Style="{StaticResource DescStyle}"/>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="15"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <Button Grid.Column="0" 
                    Content="🔒 Заблокировать обновления" 
                    Height="45" 
                    Background="#2D2D2D" 
                    Foreground="White" 
                    FontWeight="Bold"
                    Cursor="Hand"
                    Command="{Binding BlockUpdatesCommand}">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="5" BorderBrush="#FF4500" BorderThickness="1">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="border" Property="Background" Value="#3A1A1A"/>
                                            </Trigger>
                                            <Trigger Property="IsPressed" Value="True">
                                                <Setter TargetName="border" Property="Background" Value="#4A0000"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>

                            <Button Grid.Column="2" 
                    Content="🔓 Разрешить обновления" 
                    Height="45" 
                    Background="#2D2D2D" 
                    Foreground="White" 
                    FontWeight="Bold"
                    Cursor="Hand"
                    Command="{Binding EnableUpdatesCommand}">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="5" BorderBrush="#00AA00" BorderThickness="1">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="border" Property="Background" Value="#1A3A1A"/>
                                            </Trigger>
                                            <Trigger Property="IsPressed" Value="True">
                                                <Setter TargetName="border" Property="Background" Value="#004A00"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </Grid>

                        <TextBlock Text="Для ручной проверки обновлений — нажмите 'Разрешить обновления', затем проверьте в Настройках → Обновления."
                   Foreground="#AAA" FontSize="11" Margin="0,15,0,0"/>

                        <CheckBox Content="🔄 Бесконечная пауза обновлений (рекомендуется)" 
          IsChecked="{Binding IsInfinitePauseEnabled}"
          Margin="0,20,0,0"/>
                        <TextBlock Text="Задача в планировщике каждый день продлевает паузу на 35 дней.&#x0a;Самый безопасный и стабильный способ — Store работает, ничего не ломается.&#x0a;Легко снимается одним кликом."
           Style="{StaticResource DescStyle}" Foreground="#AAFFAA"/>
					<CheckBox Content="Блокировать драйверы Windows Update" IsChecked="{Binding IsDriverUpdateDisabled}"/>
                        <TextBlock Text="Не даёт самовольно Windows скачивать/обновлять драйвера из центра обновлений" Style="{StaticResource DescStyle}"/>
                    </StackPanel>
                </Border>




                <!-- НОВЫЙ РАЗДЕЛ: ПРОЧИЕ ТВИКИ -->
                <TextBlock Text="ПРОЧИЕ ТВИКИ" Style="{StaticResource HeaderStyle}" Foreground="#FFD700"/>
                <Border Style="{StaticResource GroupBorder}" BorderBrush="#FFD700" BorderThickness="1">
                    <StackPanel>
                        <TextBlock Text="Полезные оптимизации для игр и производительности" FontWeight="Bold" Foreground="#FFEEAA" Margin="0,0,0,10"/>
                        <TextBlock Text="Эти настройки популярны среди геймеров в 2025 году. Большинство применяются мгновенно или после перезагрузки.&#x0a;Даёт +5–20 FPS, меньше лагов при Alt+Tab и стабильнее 1% lows."
                                   Foreground="#AAA" FontSize="12" TextWrapping="Wrap" Margin="0,0,0,15"/>

                        <CheckBox Content="Отключить Memory Integrity (HVCI / Core Isolation)" IsChecked="{Binding IsMemoryIntegrityDisabled}"
                                  Margin="0,8,0,0"/>
                        <TextBlock Text="Отключает виртуализацию безопасности. Значительно повышает FPS в CPU-зависимых играх (Valorant, CS2, Warzone), но снижает защиту от эксплойтов."
                                   Style="{StaticResource DescStyle}"/>

                        <CheckBox Content="Включить Hardware-accelerated GPU Scheduling (HAGS)" IsChecked="{Binding IsHagsEnabled}"
                                  Margin="0,12,0,0"/>
                        <TextBlock Text="Снижает задержку ввода и повышает FPS в DX12/Vulkan играх. В Windows 11 25H2 работает стабильно."
                                   Style="{StaticResource DescStyle}"/>

                        <CheckBox Content="Отключить уведомления Windows (Focus Assist)" IsChecked="{Binding IsNotificationsDisabled}"
                                  Margin="0,12,0,0"/>
                        <TextBlock Text="Убирает всплывающие уведомления во время игры — предотвращает падения FPS от прерываний."
                                   Style="{StaticResource DescStyle}"/>

                        <CheckBox Content="Повысить приоритет игр (High Priority)" IsChecked="{Binding IsGamePriorityHigh}"
                                  Margin="0,12,0,0"/>
                        <TextBlock Text="Игровые процессы получают высокий приоритет CPU/GPU. Улучшает стабильность кадров в многозадачности."
                                   Style="{StaticResource DescStyle}"/>

                        <CheckBox Content="Отключить Fast Startup" IsChecked="{Binding IsFastStartupDisabled}"
                                  Margin="0,12,0,0"/>
                        <TextBlock Text="Фиксит stuttering и микрофризы в некоторых играх после обновлений 24H2/25H2."
                                   Style="{StaticResource DescStyle}"/>

                        <CheckBox Content="Ускорить анимации меню (MenuShowDelay = 0)" IsChecked="{Binding IsMenuDelayZero}"
                                  Margin="0,12,0,0"/>
                        <TextBlock Text="Мгновенное открытие меню Пуск и контекстных меню — меньше лагов при Alt+Tab."
                                   Style="{StaticResource DescStyle}"/>

                        <CheckBox Content="Отключить фоновые приложения" IsChecked="{Binding IsBackgroundAppsDisabled}"
                                  Margin="0,12,0,0"/>
                        <TextBlock Text="Запрещает приложениям из Microsoft Store (Погода, Фото, Xbox и др.) работать в фоне. Экономит CPU/RAM и снижает прерывания в играх."
                                   Style="{StaticResource DescStyle}"/>
                    </StackPanel>
                </Border>


                <TextBlock Text="АКТИВАЦИЯ WINDOWS / OFFICE" Style="{StaticResource HeaderStyle}" Foreground="#FF9100"/>
                <Border Style="{StaticResource GroupBorder}" BorderBrush="#FF9100" BorderThickness="1">
                    <StackPanel>
                        <TextBlock Text="Microsoft Activation Scripts (MAS)" FontWeight="Bold" Foreground="#FFFFAA" Margin="0,0,0,10"/>
                        <TextBlock Text="Надёжный открытый инструмент для перманентной активации.&#x0a;• Windows: HWID (цифровая лицензия навсегда)&#x0a;• Office: OHook или TSforge (авто-обновление)&#x0a;Требуется интернет. После нажатия откроется меню — выберите зелёный пункт (1 или 2)."
   Style="{StaticResource DescStyle}" Foreground="#FFAAAA" Margin="0,0,0,15"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="15"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Button Grid.Column="0" Content="🔑 Активировать Windows (HWID)" Height="45" Background="#2D2D2D" Foreground="White" FontWeight="Bold" Cursor="Hand" Click="BtnActivateWindows_Click">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="5" BorderBrush="#FF9100" BorderThickness="1">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                            <Button Grid.Column="2" Content="🔑 Активировать Office (OHook)" Height="45" Background="#2D2D2D" Foreground="White" FontWeight="Bold" Cursor="Hand" Click="BtnActivateOffice_Click">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="5" BorderBrush="#FF9100" BorderThickness="1">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </Grid>
                    </StackPanel>
                </Border>


				<TextBlock Text="MSI MODE (Message Signaled Interrupts)"
           Style="{StaticResource HeaderStyle}"
           Foreground="#00D4FF"/>

				<Border Style="{StaticResource GroupBorder}" BorderBrush="#00D4FF" BorderThickness="1">
					<StackPanel>
				<TextBlock Text="MSI MODE"
					   FontWeight="Bold"
					   Foreground="#00FFAA"
					   Margin="0,0,0,10"
					   HorizontalAlignment="left"
					   TextAlignment="Left"/>

				<TextBlock Text="Функция MSI Mode позволяет оптимизировать обработку прерываний от видеокарты и звуковой карты, что заметно повышает плавность и отзывчивость системы в играх.
Включение режима MSI для видеокарты (NVIDIA или AMD) практически всегда даёт положительный результат: уменьшаются микрофризы, улучшается плавность изображения, становится более чётким и быстрым управление мышью.
Включение MSI для звуковой карты рекомендуется только в случае наличия проблем со звуком — щелчков, треска или прерывистости в наушниках/колонках во время игры.
Настройки полностью безопасны, легко отключаются и не влияют на стабильность работы системы. Для большинства пользователей достаточно активировать режим только для видеокарты — это даёт максимальный эффект при минимальных действиях."
				       Foreground="#AAA" FontSize="12" TextWrapping="Wrap" Margin="0,0,0,15"
				       HorizontalAlignment="Stretch"
				       TextAlignment="Justify"/>

						<Button Content="Обновить список устройств"
								Height="35" Margin="0,0,0,10"
								Background="#2D2D2D" Foreground="White"
								Click="BtnRefreshMsiList_Click"/>

						<ListView ItemsSource="{Binding MsiCapableDevices}"
								  Height="220"
								  Background="Transparent"
								  BorderThickness="0">
							<ListView.View>
								<GridView>
									<GridViewColumn Header="Вкл MSI" Width="90">
										<GridViewColumn.CellTemplate>
											<DataTemplate>
												<CheckBox IsChecked="{Binding MsiCurrentlyEnabled, Mode=TwoWay}"
														  IsEnabled="{Binding SupportsMsi}"
														  Checked="MsiCheckBox_Changed"
														  Unchecked="MsiCheckBox_Changed"/>
											</DataTemplate>
										</GridViewColumn.CellTemplate>
									</GridViewColumn>

									<GridViewColumn Header="Устройство" Width="380">
										<GridViewColumn.CellTemplate>
											<DataTemplate>
												<TextBlock Text="{Binding DeviceName}"
														   Foreground="{Binding IsRecommended, Converter={StaticResource BoolToColor}}"
														   FontWeight="{Binding IsRecommended, Converter={StaticResource BoolToBold}}"/>
											</DataTemplate>
										</GridViewColumn.CellTemplate>
									</GridViewColumn>

									<GridViewColumn Header="Тип" Width="180">
										<GridViewColumn.CellTemplate>
											<DataTemplate>
												<TextBlock Text="{Binding FriendlyName}" Foreground="#888"/>
											</DataTemplate>
										</GridViewColumn.CellTemplate>
									</GridViewColumn>
								</GridView>
							</ListView.View>
						</ListView>

						<TextBlock Text="⚠ После изменения нужна перезагрузка!"
								   Foreground="#FFAA00" FontSize="11" Margin="0,10,0,0"/>
					</StackPanel>
				</Border>

                <TextBlock Text="ОБОИ" Style="{StaticResource HeaderStyle}" Foreground="#FFD700"/>
                <Border Style="{StaticResource GroupBorder}">
                    <StackPanel>
                        <TextBlock Text="Папка 'images':" Foreground="#888" FontSize="11" Margin="0,0,0,5"/>
                        <ListBox ItemsSource="{Binding Wallpapers}" 
                 SelectedItem="{Binding SelectedWallpaper}"
                 MinHeight="120" MaxHeight="300"
                 Background="Transparent" BorderThickness="0"
                 ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                 HorizontalContentAlignment="Stretch">
                            <ListBox.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <WrapPanel Orientation="Horizontal" IsItemsHost="True"/>
                                </ItemsPanelTemplate>
                            </ListBox.ItemsPanel>
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <Border BorderBrush="#444" BorderThickness="1" Margin="5" CornerRadius="6" Background="#252525">
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            <Image Source="{Binding Image}" Width="160" Height="90" Stretch="UniformToFill" Margin="2"/>
                                            <TextBlock Grid.Row="1" Text="{Binding Name}" Foreground="#AAA" FontSize="10" 
                                       HorizontalAlignment="Center" Margin="0,2,0,5" TextTrimming="CharacterEllipsis" MaxWidth="150"/>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                        <Button Click="BtnSetWallpaper_Click" Content="ПРИМЕНИТЬ ОБОИ" Height="35" Margin="0,15,0,0"
                Background="#333" Foreground="White" BorderThickness="0" FontWeight="Bold" Cursor="Hand">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="5">
                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="border" Property="Background" Value="#444"/>
                                        </Trigger>
                                        <Trigger Property="IsPressed" Value="True">
                                            <Setter TargetName="border" Property="Background" Value="#222"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                    </StackPanel>
                </Border>

                
                <TextBlock Text="ДЕЙСТВИЯ" Style="{StaticResource HeaderStyle}" Foreground="#FF6B6B"/>
                <Grid Margin="0,5,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="15"/>
                    </Grid.ColumnDefinitions>
                    <Button Grid.Column="0" Click="BtnClean_Click" Height="45" Background="#2D2D2D" BorderThickness="0" Cursor="Hand">
                        <TextBlock Text="🗑 Очистить кэш" Foreground="White" FontWeight="Bold"/>
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="5">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="border" Property="Background" Value="#3D3D3D"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                    
                </Grid>

            </StackPanel>
        </ScrollViewer>

        <Border Grid.Row="2" Background="#1A1A1A" BorderBrush="#333" BorderThickness="0,1,0,0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="120"/>
                </Grid.RowDefinitions>
                <ProgressBar Grid.Row="0" Height="3" BorderThickness="0" Background="Transparent" Foreground="#B388FF"
                             IsIndeterminate="True" Visibility="{Binding IsBusy, Converter={StaticResource BoolToVis}}"/>
                <TextBox Grid.Row="1" x:Name="ConsoleBox"
                         Text="{Binding LogText, Mode=OneWay}"
                         TextChanged="ConsoleBox_TextChanged"
                         Background="Transparent" Foreground="#999" 
                         FontFamily="Consolas" FontSize="12"
                         BorderThickness="0" Padding="15"
                         VerticalScrollBarVisibility="Auto"
                         IsReadOnly="True" TextWrapping="Wrap"/>
            </Grid>
        </Border>
    </Grid>
</Window>
